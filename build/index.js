/*! For license information please see index.js.LICENSE.txt */
!function(){"use strict";var e={"./src/formats/footnote.js":function(e,t,o){o.r(t);var n=o("@wordpress/element"),r=o("@wordpress/block-editor"),s=o("@wordpress/i18n"),c=o("@wordpress/rich-text"),i=o("./src/plugins/transformations.js");const l=e=>`<a class="wholesome-footnote" href="#${(new Date).valueOf().toString()}">${e}<sup>0</sup></a>`;(0,c.registerFormatType)("wholesome/footnotes",{className:"wholesome-footnote",edit:e=>{const{isActive:t,onChange:o,value:a}=e;return(0,n.createElement)(r.RichTextToolbarButton,{icon:"info-outline",onClick:()=>{const e=wp.richText.getTextContent(a).substring(a.start,a.end);o((0,c.insert)(a,(0,c.create)({html:l(e)}))),(0,i.setFootnoteNumbers)()},title:(0,s.__)("Footnote","wholesome-footnotes")})},tagName:"a",title:(0,s.__)("Footnote","wholesome-footnotes")})},"./src/plugins/transformations.js":function(e,t,o){o.r(t),o.d(t,{setFootnoteNumbers:function(){return s},setFootnotesOnOrderChange:function(){return c}});var n=o("@wordpress/blocks"),r=o("@wordpress/data");const s=()=>{let e=1;const t=wp.data.select("core/block-editor").getBlocks(),o=wp.data.select("core/block-editor").getSelectedBlock(),s={};t.forEach(t=>{const{content:n}=t.attributes;if(n.includes('class="wholesome-footnote"')){n.match(/<a[\S\s]*? class="wholesome-footnote">[\S\s]*?<\/a>/gi).forEach(r=>{const c=`<sup>${e}</sup>`;if(!r.includes(c)){const e=r.match(/<sup>[\S\s]*?<\/sup>/gi),i=r.replace(e,c),l=s[t.clientId];l?l.newContent=l.newContent.replace(r,i):s[t.clientId]={...t,newContent:n.replace(r,i),isSelected:o&&o.clientId===t.clientId}}e++})}}),Object.values(s).forEach(e=>{const{name:t,newContent:o,isSelected:s}=e,c=(0,n.createBlock)(t,{content:o});(0,r.dispatch)("core/block-editor").replaceBlock(e.clientId,c),s&&(0,r.dispatch)("core/block-editor").selectBlock(c.clientId)})},c=(e=[],t=[])=>{const o=(0,r.subscribe)(()=>{e||(e=(0,r.select)("core/block-editor").getBlockOrder());const n=(0,r.select)("core/block-editor").getBlocks(),i=(0,r.select)("core/block-editor").getBlockOrder();n&&e!==i&&t!==i&&(t=i,setTimeout(()=>{((e,t)=>{s(),c(e,t)})(e,t),o()},500))})}},"@wordpress/block-editor":function(e){e.exports=window.wp.blockEditor},"@wordpress/blocks":function(e){e.exports=window.wp.blocks},"@wordpress/data":function(e){e.exports=window.wp.data},"@wordpress/element":function(e){e.exports=window.wp.element},"@wordpress/i18n":function(e){e.exports=window.wp.i18n},"@wordpress/rich-text":function(e){e.exports=window.wp.richText}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){o.r(n);o("./src/formats/footnote.js");(0,o("./src/plugins/transformations.js").setFootnotesOnOrderChange)()}()}();
//# sourceMappingURL=index.js.map