{"version":3,"file":"index.js","mappings":"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","sources":["webpack://wholesome-footnotes/./src/editor.scss","webpack://wholesome-footnotes/./src/blocks/footnote-list.js","webpack://wholesome-footnotes/./src/components/WysiwygControl.js","webpack://wholesome-footnotes/./src/formats/footnote.js","webpack://wholesome-footnotes/./src/plugins/transformations.js","webpack://wholesome-footnotes/external window \"lodash\"","webpack://wholesome-footnotes/external window [\"wp\",\"blockEditor\"]","webpack://wholesome-footnotes/external window [\"wp\",\"blocks\"]","webpack://wholesome-footnotes/external window [\"wp\",\"components\"]","webpack://wholesome-footnotes/external window [\"wp\",\"data\"]","webpack://wholesome-footnotes/external window [\"wp\",\"domReady\"]","webpack://wholesome-footnotes/external window [\"wp\",\"element\"]","webpack://wholesome-footnotes/external window [\"wp\",\"i18n\"]","webpack://wholesome-footnotes/external window [\"wp\",\"keycodes\"]","webpack://wholesome-footnotes/external window [\"wp\",\"richText\"]","webpack://wholesome-footnotes/webpack/bootstrap","webpack://wholesome-footnotes/webpack/runtime/compat get default export","webpack://wholesome-footnotes/webpack/runtime/define property getters","webpack://wholesome-footnotes/webpack/runtime/hasOwnProperty shorthand","webpack://wholesome-footnotes/webpack/runtime/make namespace object","webpack://wholesome-footnotes/./src/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","import { useBlockProps } from '@wordpress/block-editor';\nimport { registerBlockType } from '@wordpress/blocks';\nimport { useSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\n\nregisterBlockType(\n\t'wholesome/footnote-list',\n\t{\n\t\tapiVersion: 2,\n\t\tcategory: 'design',\n\t\tdescription: __( 'A list of this posts footnotes.', 'wholesome-footnote' ),\n\t\tedit: ( props ) => {\n\t\t\tconst blockProps = useBlockProps( {\n\t\t\t\tclassName: 'wholesome-footnote-list',\n\t\t\t} );\n\n\t\t\tconst meta = useSelect( ( select ) => select( 'core/editor' ).getEditedPostAttribute( 'meta' ) );\n\t\t\tlet footnotes = meta[ 'wholesome_footnotes' ] || [];\n\n\t\t\tif ( ! footnotes ) {\n\t\t\t\treturn null; // @todo: put a message here.\n\t\t\t}\n\n\t\t\tfootnotes = footnotes.sort( ( a, b ) => a.order - b.order );\n\n\t\t\treturn (\n\t\t\t\t<div { ...blockProps }>\n\t\t\t\t\t<ol>\n\t\t\t\t\t\t{ footnotes.map( ( note ) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<li key={ note.uid } dangerouslySetInnerHTML={ { __html: note.footnote } }/>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} )}\n\t\t\t\t\t</ol>\n\t\t\t\t</div>\n\t\t\t);\n\t\t},\n\t\ticon: 'editor-ol',\n\t\tsave: () => {},\n\t\tsupports: {\n\t\t\talign: true,\n\t\t},\n\t\ttextdomain: 'wholesome-footnote',\n\t\ttitle: __( 'Footnote List', 'wholesome-footnote' ),\n\t}\n);\n","/**\n * WYSIWYG Control.\n *\n * Forked from https://github.com/TomodomoCo/wp-wysiwyg-control/.\n *\n * \"The repo is not designed to be used out of the box, but rather as a starting point for\n * your own integration. As such, you can't \"install\" it via npm or another package manager;\n * instead, you should copy the files to your project.\"\n */\n\n/**\n * WordPress dependencies\n */\nimport { BaseControl } from '@wordpress/components';\nimport { Component } from '@wordpress/element';\nimport { __, _x } from '@wordpress/i18n';\nimport { F10 } from '@wordpress/keycodes';\nimport domReady from '@wordpress/dom-ready';\n\n/**\n * External dependencies\n */\nimport { uniqueId } from 'lodash';\n\nconst { wp } = window;\n\n/**\n * Is TMCE Empty?.\n *\n * @param object editor Editor.\n * @returns bool\n */\nfunction isTmceEmpty( editor ) {\n\t// When tinyMce is empty the content seems to be:\n\t// <p><br data-mce-bogus=\"1\"></p>\n\t// avoid expensive checks for large documents\n\tconst body = editor.getBody();\n\n\tif ( body.childNodes.length > 1 ) {\n\t\treturn false;\n\t}\n\n\tif ( body.childNodes.length === 0 ) {\n\t\treturn true;\n\t}\n\n\tif ( body.childNodes[ 0 ].childNodes.length > 1 ) {\n\t\treturn false;\n\t}\n\n\treturn /^\\n?$/.test( body.innerText || body.textContent );\n}\n\nclass WysiwygControl extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.initialize = this.initialize.bind( this );\n\t\tthis.onSetup = this.onSetup.bind( this );\n\t\tthis.focus = this.focus.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { baseURL, suffix } = window.wpEditorL10n.tinymce;\n\n\t\twindow.tinymce.EditorManager.overrideDefaults( {\n\t\t\tbase_url: baseURL,\n\t\t\tsuffix,\n\t\t} );\n\n\t\tdomReady( () => this.initialize() );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { slug } = this.props;\n\n\t\twindow.addEventListener( 'DOMContentLoaded', this.initialize );\n\t\twp.oldEditor.remove( `editor-${ slug }` );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst {\n\t\t\tslug,\n\t\t\tvalue,\n\t\t} = this.props;\n\n\t\tconst editor = window.tinymce.get( `editor-${ slug }` );\n\n\t\tif ( prevProps.value !== value ) {\n\t\t\teditor.setContent( value || '' );\n\t\t}\n\t}\n\n\tinitialize() {\n\t\tconst {\n\t\t\tsettings = {\n\t\t\t\tplugins: 'charmap,colorpicker,hr,lists,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpautoresize,wpeditimage,wpemoji,wpgallery,wplink,wpdialogs,wptextpattern,wpview',\n\t\t\t\texternal_plugins: [],\n\t\t\t\tclassic_block_editor: true,\n\t\t\t},\n\t\t\tslug,\n\t\t\ttoolbars = {\n\t\t\t\ttoolbar1: 'formatselect,wp_add_media,wp_adv,bold,italic,bullist,numlist,strikethrough,link',\n\t\t\t\ttoolbar2: 'pastetext,removeformat,charmap,undo,redo,wp_help',\n\t\t\t\ttoolbar3: '',\n\t\t\t\ttoolbar4: '',\n\t\t\t},\n\t\t\tformats = 'Paragraph=p;Heading=h2;Subheading=h3',\n\t\t} = this.props;\n\n\t\tconst editorSettings = {\n\t\t\t...settings,\n\t\t\t...toolbars,\n\t\t\tblock_formats: formats,\n\t\t};\n\n\t\twp.oldEditor.initialize( `editor-${ slug }`, {\n\t\t\ttinymce: {\n\t\t\t\t...editorSettings,\n\t\t\t\tinline: true,\n\t\t\t\tcontent_css: false,\n\t\t\t\tfixed_toolbar_container: `#toolbar-${ slug }`,\n\t\t\t\tsetup: this.onSetup,\n\t\t\t},\n\t\t} );\n\t}\n\n\tonSetup( editor ) {\n\t\tconst {\n\t\t\tonChange,\n\t\t\tvalue,\n\t\t} = this.props;\n\n\t\tconst { ref } = this;\n\t\tlet bookmark;\n\n\t\tthis.editor = editor;\n\n\t\tif ( value ) {\n\t\t\teditor.on( 'loadContent', () => editor.setContent( value ) );\n\t\t}\n\n\t\teditor.on( 'blur', () => {\n\t\t\tbookmark = editor.selection.getBookmark( 2, true );\n\n\t\t\tonChange( editor.getContent() );\n\n\t\t\teditor.once( 'focus', () => {\n\t\t\t\tif ( bookmark ) {\n\t\t\t\t\teditor.selection.moveToBookmark( bookmark );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn false;\n\t\t} );\n\n\t\teditor.on( 'mousedown touchstart', () => {\n\t\t\tbookmark = null;\n\t\t} );\n\n\t\teditor.on( 'keydown', ( event ) => {\n\t\t\tconst { altKey } = event;\n\n\t\t\t/*\n\t\t\t * Prevent Mousetrap from kicking in: TinyMCE already uses its own\n\t\t\t * `alt+f10` shortcut to focus its toolbar.\n\t\t\t */\n\t\t\tif ( altKey && event.keyCode === F10 ) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t} );\n\n\t\teditor.on( 'init', () => {\n\t\t\tconst rootNode = this.editor.getBody();\n\n\t\t\t// Create the toolbar by refocussing the editor.\n\t\t\tif ( document.activeElement === rootNode ) {\n\t\t\t\trootNode.blur();\n\t\t\t\tthis.editor.focus();\n\t\t\t}\n\t\t} );\n\t}\n\n\tfocus() {\n\t\tif ( this.editor ) {\n\t\t\tthis.editor.focus();\n\t\t}\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonToolbarKeyDown( event ) {\n\t\t// Prevent WritingFlow from kicking in and allow arrows navigation on the toolbar.\n\t\tevent.stopPropagation();\n\n\t\t// Prevent Mousetrap from moving focus to the top toolbar when pressing `alt+f10` on this block toolbar.\n\t\tevent.nativeEvent.stopImmediatePropagation();\n\t}\n\n\trender() {\n\t\tconst { slug } = this.props;\n\n\t\t// Disable reasons:\n\t\t//\n\t\t// jsx-a11y/no-static-element-interactions\n\t\t//  - the toolbar itself is non-interactive, but must capture events\n\t\t//    from the KeyboardShortcuts component to stop their propagation.\n\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\treturn (\n\t\t\t<BaseControl { ...this.props }>\n\t\t\t\t<div className=\"wysiwyg-control\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey=\"toolbar\"\n\t\t\t\t\t\tid={ `toolbar-${ slug }` }\n\t\t\t\t\t\tref={ ( ref ) => { this.ref = ref; } }\n\t\t\t\t\t\tclassName=\"block-library-classic__toolbar wysiwyg-control__toolbar\"\n\t\t\t\t\t\tonClick={ this.focus }\n\t\t\t\t\t\tdata-placeholder={ __( 'Click to edit' ) }\n\t\t\t\t\t\tonKeyDown={ this.onToolbarKeyDown }\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey=\"editor\"\n\t\t\t\t\t\tid={ `editor-${ slug }` }\n\t\t\t\t\t\tclassName=\"wp-block-freeform block-library-rich-text__tinymce wysiwyg-control__body\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</BaseControl>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t}\n}\n\nexport default WysiwygControl;\n","/**\n * Footnotes.\n */\n\n// Import WordPress Components.\nimport { RichTextToolbarButton, URLPopover } from '@wordpress/block-editor';\nimport { Button, Modal } from '@wordpress/components';\nimport { dispatch, useSelect } from '@wordpress/data';\nimport { useState } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { create, getTextContent, insert, registerFormatType, removeFormat, toggleFormat, useAnchorRef } from '@wordpress/rich-text';\n\nimport WysiwygControl from '../components/WysiwygControl';\nimport { setFootnoteNumbers } from '../plugins/transformations';\n\nconst name = 'wholesome/footnotes';\n\nconst FootnoteBlock = ( text, uid ) => {\n\tconst number = '0';\n\tconst matches = text.match( /<a[\\S\\s]*? class=\"wholesome-footnote\">[\\S\\s]*?<\\/a>/gi );\n\treturn `<a class=\"wholesome-footnote\" id=\"${ uid }\" href=\"#footnote-${ uid }\">${ text }<sup class=\"wholesome-footnote__number\">${ number }</sup></a>`;\n};\n\n// Create Footnotes Button with Colour Selection Popover.\nconst FootnotesButton = ( props ) => {\n\tconst { contentRef, isActive, onChange, value } = props;\n\tconst { activeFormats } = value;\n\n\t// State to show popover.\n\tconst [ showPopover, setShowPopover ] = useState( false );\n\tconst [ footnote, setFootnote ] = useState( '' );\n\n\tconst meta = useSelect( ( select ) => select( 'core/editor' ).getEditedPostAttribute( 'meta' ) );\n\tconst footnotes = meta[ 'wholesome_footnotes' ] || [];\n\n\tconst getActiveFootnote = () => {\n\t\tconst uid = getActiveFootnoteUID();\n\t\tconst selectedFootnote = footnotes?.filter( footnote => uid === footnote.uid );\t\t\n\t\tif ( selectedFootnote && selectedFootnote.length ) {\n\t\t\treturn selectedFootnote[0]?.footnote || '';\n\t\t}\n\n\t\treturn '';\n\t};\n\n\tconst getActiveFootnoteUID = () => {\n\t\tconst formats = activeFormats.filter( ( format ) => name === format.type );\n\n\t\tif ( formats.length > 0 ) {\n\t\t\tconst format = formats[ 0 ];\n\t\t\tconst { attributes, unregisteredAttributes } = format;\n\n\t\t\tlet appliedAttributes = unregisteredAttributes;\n\n\t\t\tif ( attributes && attributes.length ) {\n\t\t\t\tappliedAttributes = attributes;\n\t\t\t}\n\n\t\t\tif ( ! appliedAttributes ) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif ( Object.prototype.hasOwnProperty.call( appliedAttributes, 'id' ) ) {\n\t\t\t\tconst { id } = appliedAttributes;\n\t\t\t\treturn id;\n\t\t\t}\n\t\t}\n\t\treturn '';\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<RichTextToolbarButton\n\t\t\t\ticon=\"info-outline\"\n\t\t\t\t// key={ isActive ? 'footnote' : 'footnotes-not-active' }\n\t\t\t\t// name={ isActive ? 'footnote' : undefined }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tsetShowPopover( true );\n\t\t\t\t} }\n\t\t\t\ttitle={ __( 'Footnote', 'wholesome-footnotes' ) }\n\t\t\t/>\n\t\t\t{ showPopover && (\n\t\t\t\t<Modal\n\t\t\t\t\tclassName=\"footnotes-popover\"\n\t\t\t\t\tonRequestClose={ () => { setShowPopover( false );  } }\n\t\t\t\t\ttitle={ __( 'Footnote', 'wholesome-footnotes' ) }\n\t\t\t\t>\n\t\t\t\t\t<WysiwygControl\n\t\t\t\t\t\tlabel={ __( 'Enter Footnote:', 'wholesome-footnotes' ) }\n\t\t\t\t\t\tslug={ `${ contentRef?.current?.id }-footnote` }\n\t\t\t\t\t\tonChange={ ( footnote ) => {\n\t\t\t\t\t\t\tsetFootnote( footnote );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonLoad={\n\t\t\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t\t\tconst tinyMce = document.querySelector( `#editor-${ contentRef?.current?.id }-footnote` );\n\t\t\t\t\t\t\t\tif ( tinyMce ) {\n\t\t\t\t\t\t\t\t\ttinyMce.focus();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 500 )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue={ getActiveFootnote() }\n\t\t\t\t\t\ttoolbars={ {\n\t\t\t\t\t\t\ttoolbar1: 'bold,italic,bullist,numlist,link,removeformat',\n\t\t\t\t\t\t\ttoolbar2: '',\n\t\t\t\t\t\t\ttoolbar3: '',\n\t\t\t\t\t\t\ttoolbar4: '',\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<Button  \n\t\t\t\t\t\tclassName=\"button button-secondary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tlet text = getTextContent( value ).substring( value.start, value.end );\n\t\t\t\t\t\t\tlet uid = getActiveFootnoteUID();\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( ! footnote ) {\n\t\t\t\t\t\t\t\tonChange( toggleFormat( value, { type: name } ) ); // Remove Format.\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( footnote && ! uid ) {\n\t\t\t\t\t\t\t\tuid = new Date().valueOf().toString();\n\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\tinsert(\n\t\t\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\t\t\tcreate( {\n\t\t\t\t\t\t\t\t\t\t\thtml: FootnoteBlock( text, uid ),\n\t\t\t\t\t\t\t\t\t\t} ),\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst newFootnotes = [...footnotes];\n\t\t\t\t\t\t\tconst key = Object.keys( newFootnotes ).find( key => newFootnotes[ key ].uid === uid ) || null;\n\t\t\t\t\t\t\tconst order = newFootnotes[uid]?.order || 0;\n\n\t\t\t\t\t\t\tconst note = {\n\t\t\t\t\t\t\t\tuid,\n\t\t\t\t\t\t\t\tfootnote,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tif ( key ) {\n\t\t\t\t\t\t\t\tnewFootnotes[ key ] = note;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewFootnotes.push( note );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdispatch( 'core/editor' ).editPost( {\n\t\t\t\t\t\t\t\tmeta: {\n\t\t\t\t\t\t\t\t\twholesome_footnotes: newFootnotes,\n\t\t\t\t\t\t\t\t\twholesome_footnotes_updated: new Date().valueOf().toString(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\tsetShowPopover( false );\n\t\t\t\t\t\t\tsetFootnote( '' );\n\t\t\t\t\t\t\tsetFootnoteNumbers();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Save', 'wholesome-footnotes' ) }\n                    </Button>\n\t\t\t\t</Modal>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\n// Register the Format.\nregisterFormatType(\n\tname, {\n\t\tclassName: 'wholesome-footnote',\n\t\tedit: FootnotesButton,\n\t\ttagName: 'a',\n\t\ttitle: __( 'Footnote', 'wholesome-footnotes' ),\n\t}\n);\n","import { createBlock } from '@wordpress/blocks';\nimport { dispatch, select, subscribe } from '@wordpress/data';\n\nexport const setFootnoteNumbers = () => {\n\tlet i = 1;\n\n\tconst blocks = select( 'core/block-editor' ).getBlocks();\n\tconst currentBlock = select( 'core/block-editor' ).getSelectedBlock();\n\tconst newBlocks = {};\n\tconst meta = select( 'core/editor' ).getEditedPostAttribute( 'meta' );\n\tconst footnotes = meta[ 'wholesome_footnotes' ] || [];\n\tconst uidOrder = {};\n\n\tblocks.forEach( ( block ) => {\n\t\tconst { content } = block.attributes;\n\t\tif ( content?.includes( 'class=\"wholesome-footnote__number\"' ) ) {\n\t\t\t// Remove orphans.\n\t\t\tconst childMatches = content.match( /<sup[^<>]+\"wholesome-footnote__number\">[^<>]+<\\/sup>\\s/gi );\n\t\t\tif ( childMatches ) {\n\t\t\t\tchildMatches.forEach( ( match ) => {\n\t\t\t\t\tconst selectedBlock = newBlocks[ block.clientId ];\n\t\t\t\t\tif ( selectedBlock ) {\n\t\t\t\t\t\tselectedBlock.newContent = selectedBlock.newContent.replace( match, '' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewBlocks[ block.clientId ] = {\n\t\t\t\t\t\t\t...block,\n\t\t\t\t\t\t\tnewContent: content.replace( match, '' ),\n\t\t\t\t\t\t\tisSelected: currentBlock && currentBlock.clientId === block.clientId,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// Reorder numbers.\n\t\t\tconst matches = content.match( /<a[\\S\\s]*? class=\"wholesome-footnote\">[\\S\\s]*?<\\/a>/gi );\n\t\t\tif ( matches ) {\n\t\t\t\tmatches.forEach( ( match ) => {\n\t\t\t\t\tconst newNumber = `<sup class=\"wholesome-footnote__number\">${ i }</sup>`;\n\t\t\t\t\tconst regex = new RegExp( 'id=\"(.*?)\"', 'gi' );\n\t\t\t\t\tconst uid = regex.exec( match )[ 1 ];\n\t\t\t\t\tif ( ! match.includes( newNumber ) ) {\n\t\t\t\t\t\tconst originalNumber = match.match( /<sup class=\"wholesome-footnote__number\">[\\S\\s]*?<\\/sup>/gi );\n\t\t\t\t\t\tconst newMatch = match.replace( originalNumber, newNumber );\n\n\t\t\t\t\t\tconst selectedBlock = newBlocks[ block.clientId ];\n\t\t\t\t\t\tif ( selectedBlock ) {\n\t\t\t\t\t\t\tselectedBlock.newContent = selectedBlock.newContent.replace( match, newMatch );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewBlocks[ block.clientId ] = {\n\t\t\t\t\t\t\t\t...block,\n\t\t\t\t\t\t\t\tnewContent: content.replace( match, newMatch ),\n\t\t\t\t\t\t\t\tisSelected: currentBlock && currentBlock.clientId === block.clientId,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuidOrder[uid] = i;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n\n\tObject.values( newBlocks ).forEach( ( block ) => {\n\t\tconst { name, newContent, isSelected } = block;\n\t\tconst newBlock = createBlock( name, { content: newContent } );\n\t\tdispatch( 'core/block-editor' ).replaceBlock(\n\t\t\tblock.clientId,\n\t\t\tnewBlock,\n\t\t);\n\n\t\tif ( isSelected ) {\n\t\t\tdispatch( 'core/block-editor' ).selectBlock( newBlock.clientId );\n\t\t}\n\t} );\n\n\tconst newFootnotes = [ ...footnotes ];\n\tlet hasFootnotesChanged = false;\n\n\t// Reorder UIDs.\n\tif ( Object.keys( uidOrder ).length > 0) {\n\t\tfor ( const [ uid, order ] of Object.entries( uidOrder ) ) {\n\t\t\tconst key = Object.keys( newFootnotes ).find( ( key ) => newFootnotes[ key ].uid === uid ) || null;\n\t\t\tif ( key ) {\n\t\t\t\tnewFootnotes[ key ] = {\n\t\t\t\t\t...newFootnotes[ key ],\n\t\t\t\t\torder,\n\t\t\t\t};\n\t\t\t\thasFootnotesChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( hasFootnotesChanged ) {\n\t\tdispatch( 'core/editor' ).editPost( {\n\t\t\tmeta: {\n\t\t\t\twholesome_footnotes: newFootnotes,\n\t\t\t\twholesome_footnotes_updated: new Date().valueOf().toString(),\n\t\t\t},\n\t\t} );\n\t}\n\n\treturn Promise.resolve();\n};\n\nconst doReorderAndResubscribe = async () => {\n\tawait setFootnoteNumbers();\n\tconst newBlockOrder = select( 'core/block-editor' ).getBlockOrder();\n\t// eslint-disable-next-line no-use-before-define\n\tsetFootnotesOnOrderChange( newBlockOrder, newBlockOrder );\n};\n\nexport const setFootnotesOnOrderChange = ( blockOrder = [], lastBlockOrder = [] ) => {\n\tconst unsubscribe = subscribe( () => {\n\t\tif ( ! blockOrder ) {\n\t\t\tblockOrder = select( 'core/block-editor' ).getBlockOrder();\n\t\t}\n\n\t\tconst blocks = select( 'core/block-editor' ).getBlocks();\n\t\tconst newBlockOrder = select( 'core/block-editor' ).getBlockOrder();\n\n\t\tif ( ! blocks || blockOrder === newBlockOrder ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( lastBlockOrder === newBlockOrder ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlastBlockOrder = newBlockOrder;\n\n\t\t// Wait until Gutenberg has done the move.\n\t\tsetTimeout( () => {\n\t\t\tdoReorderAndResubscribe();\n\t\t\tunsubscribe();\n\t\t}, 500 );\n\t} );\n};\n","module.exports = window[\"lodash\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"domReady\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"keycodes\"];","module.exports = window[\"wp\"][\"richText\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import './editor.scss';\n\nimport './blocks/footnote-list';\nimport './formats/footnote';\nimport { setFootnotesOnOrderChange } from './plugins/transformations';\n\n// Change footnote numbers when the block order changes.\nsetFootnotesOnOrderChange();\n"],"names":["useBlockProps","registerBlockType","useSelect","__","apiVersion","category","description","edit","props","blockProps","className","meta","select","getEditedPostAttribute","footnotes","sort","a","b","order","map","note","uid","__html","footnote","icon","save","supports","align","textdomain","title","BaseControl","Component","_x","F10","domReady","uniqueId","wp","window","isTmceEmpty","editor","body","getBody","childNodes","length","test","innerText","textContent","WysiwygControl","constructor","initialize","bind","onSetup","focus","componentDidMount","baseURL","suffix","wpEditorL10n","tinymce","EditorManager","overrideDefaults","base_url","componentWillUnmount","slug","addEventListener","oldEditor","remove","componentDidUpdate","prevProps","value","get","setContent","settings","plugins","external_plugins","classic_block_editor","toolbars","toolbar1","toolbar2","toolbar3","toolbar4","formats","editorSettings","block_formats","inline","content_css","fixed_toolbar_container","setup","onChange","ref","bookmark","on","selection","getBookmark","getContent","once","moveToBookmark","event","altKey","keyCode","stopPropagation","rootNode","document","activeElement","blur","onToolbarKeyDown","nativeEvent","stopImmediatePropagation","render","RichTextToolbarButton","URLPopover","Button","Modal","dispatch","useState","create","getTextContent","insert","registerFormatType","removeFormat","toggleFormat","useAnchorRef","setFootnoteNumbers","name","FootnoteBlock","text","number","matches","match","FootnotesButton","contentRef","isActive","activeFormats","showPopover","setShowPopover","setFootnote","getActiveFootnote","getActiveFootnoteUID","selectedFootnote","filter","format","type","attributes","unregisteredAttributes","appliedAttributes","Object","prototype","hasOwnProperty","call","id","current","setTimeout","tinyMce","querySelector","substring","start","end","Date","valueOf","toString","html","newFootnotes","key","keys","find","push","editPost","wholesome_footnotes","wholesome_footnotes_updated","tagName","createBlock","subscribe","i","blocks","getBlocks","currentBlock","getSelectedBlock","newBlocks","uidOrder","forEach","block","content","includes","childMatches","selectedBlock","clientId","newContent","replace","isSelected","newNumber","regex","RegExp","exec","originalNumber","newMatch","values","newBlock","replaceBlock","selectBlock","hasFootnotesChanged","entries","Promise","resolve","doReorderAndResubscribe","newBlockOrder","getBlockOrder","setFootnotesOnOrderChange","blockOrder","lastBlockOrder","unsubscribe"],"sourceRoot":""}